{"version":3,"sources":["siguoya.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"siguoya.min.js","sourcesContent":[";(function(window,$){\n    $(function(){\n        /**\n         * 全局初始化代码以及辅助方法\n         */\n        (function(){\n            /*全局jQuery变量及方法*/\n            window.$document=$(document);\n            window.$window=$(window);\n            window.yfx=function(){\n                console.log(arg);\n                return;\n            }\n            //自动在Ajax请求时,添加_token参数\n            $.ajaxSetup({\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            });\n            /*百度*/\n            if(\n                //管理后台\n                location.href.indexOf('admin')<0 &&\n                //本地\n                location.href.indexOf('localhost')<0 &&\n                //社区\n                location.href.indexOf('firstdomain')\n            ){\n                //百度统计代码\n                var _hmt=_hmt||[];\n                var hm=document.createElement(\"script\");\n                hm.src=\"//hm.baidu.com/hm.js?dbc825061da32f4cf32e3c7c56e95034\";\n                var s=document.getElementsByTagName(\"script\")[0];\n                s.parentNode.insertBefore(hm,s);\n\n                //主动推送新增链接到百度\n                var bp = document.createElement('script');\n                bp.src = '//push.zhanzhang.baidu.com/push.js';\n                var s = document.getElementsByTagName(\"script\")[0];\n                s.parentNode.insertBefore(bp, s);\n            }\n        }());\n\n        /**\n         *Bootstrap组件增强\n         */\n        (function(){\n            /*使bs3-tabs里面的组件自动切换*/\n            var $nav_tab=$('.nav-tabs'),count=$nav_tab.find('a').length,$a=$nav_tab.find('a'),order=1,timer;\n            function autoSwitch(){\n                $($a.get(order)).trigger('click');\n                order++;\n                if(order>=count){\n                    order=0;\n                }\n            }\n            timer=setInterval(autoSwitch,3000);\n            $('.tab-pane').hover(function(){\n                clearInterval(timer);\n            },function(){\n                timer=setInterval(autoSwitch,3000);\n            });\n            $('.redirectLessons').click(function(){\n                window.location.href='https://www.jetbrains.com/phpstorm/';\n            })\n        }());\n\n        /**\n         *响应式管理\n         */\n        (function(){\n            if($(window).width()<768){\n                $(\"#nav-pull-right\").removeClass('pull-right');\n            }\n        }());\n\n        /**\n         * Markdown文档管理\n         */\n        (function(){\n            /*初始化Markdown编辑器*/\n            if($('#editormd').length){\n                var editor=editormd(\"editormd\",{\n                    height:500,\n                    path:\"/vendor/editor/lib/\",\n                    emoji:true,\n                    tex:true,\n                    dialogLockScreen:true,\n                    dialogShowMask:true,\n                    dialogDraggable:false,\n                    dialogMaskOpacity:.7,\n                    dialogMaskBgColor:\"#000\",\n                    imageUpload:true,\n                    imageFormats:[\"jpg\",\"jpeg\",\"gif\",\"png\",\"bmp\",\"webp\"],\n                    imageUploadURL:'/common/file/uploadFile',\n                    tocm:true\n                });\n                /*封面上传*/\n                if($(\"#uploaderArea\").length){\n                    $(\"#uploaderArea\").dmUploader({\n                        url:'/common/file/uploadFile',\n                        extraData:{\n                            _token:$(\"input[name='_token']\").val(),\n                            filePlace:JSON.stringify({\n                                module:'Article',\n                                folderName:'articleCover'\n                            })\n                        },\n                        onUploadSuccess:function(uploadId,data){\n                            var dataObj=JSON.parse(data);\n                            articleForm.$articleCover.val(data);\n                            articleForm.$coverPreview.attr('src',dataObj['file_url']);\n                        }\n                    });\n                }\n                /*表单创建*/\n                var articleForm={\n                    $articleTitle:$(\"#articleTitle\"),\n                    $mainClassify:$(\"#articleMainClassify\"),\n                    $subClassify:$(\"#articleSubClassify\"),\n                    $articleCover:$('#articleCover'),\n                    $submitButton:$(\"#submit\"),\n                    $coverPreview:$('#coverPreview'),\n                    $articleSummary:$('#articleSummary'),\n                    $articleOriginUrl:$('#articleOriginUrl'),\n                    mainClassifyChange:function(){\n                        var mainValue=$(this).val();\n                        if(mainValue==0){\n                            articleForm.subClassifyInit();\n                        }else{\n                            articleForm.subClassifyGetList(mainValue);\n                            articleForm.$subClassify.parent().show();\n                        }\n                    },\n                    subClassifyGetList:function(mainValue){\n                        if($.isNumeric(mainValue)){\n                            $.ajax({\n                                url:\"/admin/article/ajaxClassifyList\",\n                                type:\"post\",\n                                data:{\n                                    mainId:mainValue,\n                                    _token:$(\"input[name='_token']\").val()\n                                },\n                                success:function(data){\n                                    var data=JSON.parse(data),subClassifyList;\n                                    for(var i in data){\n                                        subClassifyList+=\"<option value=\"+i+\">\"+data[i]+\"</option>\";\n                                    }\n                                    articleForm.$subClassify.empty().append(subClassifyList);\n                                }\n                            })\n                        }\n                    },\n                    mainClassifyInit:function(){\n                        this.$mainClassify.prepend('<option value=\"\">主分类</option>').val(0), this.$mainClassify.change(this.mainClassifyChange)\n                    },\n                    subClassifyInit:function(){\n                        this.$subClassify.empty().parent().hide()\n                    },\n                    submitFunc:function(i){\n                        this.validClassify.call(this), i.call(this)\n                    },\n                    validClassify:function(){\n                        /**\n                         * 不能使用this.$mainClassify.val()\n                         * 需要使用$(\"#articleMainClassify\").val()\n                         * 前者会缓存结果\n                         */\n                        if(!(articleForm.$articleTitle.val()\n                                &&\n                                articleForm.$mainClassify.val()\n                                &&\n                                articleForm.$subClassify.val()\n                                &&\n                                articleForm.$articleSummary.val()\n                                &&\n                                editor.getMarkdown()\n                            )){\n                            return false;\n                        }else{\n                            return true;\n                        }\n                    },\n                    init:function(){\n                        this.mainClassifyInit();\n                        this.subClassifyInit();\n                        this.$submitButton.click(function(){\n                            if(articleForm.validClassify()){\n                                var data={\n                                    _token:$(\"input[name='_token']\").val(),\n                                    article_title:articleForm.$articleTitle.val(),\n                                    article_main_classify:articleForm.$mainClassify.val(),\n                                    article_sub_classify:articleForm.$subClassify.val(),\n                                    article_cover:articleForm.$articleCover.val(),\n                                    article_summary:articleForm.$articleSummary.val(),\n                                    article_content:editor.getMarkdown(),\n                                    article_tags:$(\"#articleTags\").val(),\n                                    article_keywords:$('#articleKeywords').val(),\n                                    article_origin_url:function(){\n                                        return JSON.stringify(articleForm.$articleOriginUrl.val().split(','));\n                                    }\n                                };\n                                if(location.href.indexOf('edit')>0){\n                                    data['_method']='patch';\n                                    data['article_id']=($('#legend').data())['src'];\n                                }\n                                $.ajax({\n                                    url:\"/admin/article/store\",\n                                    type:\"post\",\n                                    data:data,\n                                    success:function(data){\n                                        if(data==1){\n                                            location.href='/admin/article';\n                                        }\n                                    }\n                                });\n                            }else{\n                                alert('标题,分类,配图,内容都不得为空');\n                            }\n                            return false;\n                        })\n                    }\n                };\n                articleForm.init();\n            }\n            /*解析Markdown*/\n            if($('#mdContainer').length){\n                editormd.markdownToHTML('markdown',{\n                    markdown:$('#mdContainer').val(),\n                    //htmlDecode      : true,       // 开启 HTML 标签解析，为了安全性，默认不开启\n                    //htmlDecode      : \"style,script,iframe\",  // you can filter tags decode\n                    //toc             : false,\n                    //tocm            : true,    // Using [TOCM]\n                    //tocContainer    : \"#custom-toc-container\", // 自定义 ToC 容器层\n                    //gfm             : true,\n                    //tocDropdown     : true,\n                    markdownSourceCode : true, // 是否保留 Markdown 源码，即是否删除保存源码的 Textarea 标签\n                });\n                /*解析文章来源*/\n                var $originObj=$('#articleOriginSource');\n                if($originObj.length){\n                    try{\n                        var originUrlObj=JSON.parse($originObj.text());\n                        $('#articleOriginSource').text(\n                            '作者:'+originUrlObj[0]+'\\r\\n 原文链接:'+originUrlObj[1]\n                        ).attr('href',originUrlObj[1]);\n                    }catch(e){\n                        console.log('Bug:JSON字符串解析出错');\n                    }\n\n                }\n            }\n        }());\n\n        /**\n         *  Trash\n         */\n        (function(){\n            window.global={\n\n                $loading:$('.common_loading'),\n                $modalTitle:$('#modalTitle'),\n                $modalContent:$('#modalContent'),\n                $modalCancelButton:$('#modalCancelButton'),\n                $modalOkButton:$('#modalOkButton'),\n                $dialogButton:$('#dialogButton'),\n                $dialogClose:$('#modalClose'),\n\n                //弹窗\n                dialogOpen:function(customConfig,scope){\n                    //默认配置\n                    var config= $.extend({\n                        title:'标题',\n                        content:'内容',\n                        showOk:false,\n                        showCancel:false,\n                        okFunc:null,\n                        cancelFunc:null,\n                        redirectUrl:''\n                    },customConfig);\n                    //标题\n                    global.$modalTitle.html(config.title);\n                    //内容\n                    global.$modalContent.html(config.content);\n                    //操作\n                    //显示与隐藏操作按钮\n                    config.showCancel? global.$modalCancelButton.show():true;\n                    config.showOk? global.$modalOkButton.show():true;\n                    //确定与取消按钮绑定的事件\n                    if(config.okFunc){\n                        global.$modalOkButton.unbind('click');\n                        global.$modalOkButton.click(function(){\n                            config.okFunc.call(scope);\n                        });\n                    }\n                    //弹出Modal框\n                    global.$dialogButton.trigger('click');\n                    //是否自动跳转\n                    if(config.redirectUrl){\n                        setTimeout(function(){\n                            window.location.href=config.redirectUrl;\n                        },2500);\n                    }\n                },\n                dialogClose:function(waitTime){\n                    var waitTime=waitTime?waitTime:0;\n                    setTimeout(function(){\n                        global.$dialogClose.trigger('click');\n                    },waitTime);\n                },\n                dialogDestroy:function(){\n                    global.dialogClose();\n                    global.$modalCancelButton.unbind('click').hide();\n                    global.$modalOkButton.unbind('click');\n                    global.$modalOkButton.click(function(){\n                        global.dialogClose();\n                    });\n                },\n                //检测用户是否登录\n                isLogin:function(){\n                    return $.cookie('user_info')?true:false;\n                },\n                //从cookie中获取信息\n                userInfo:function(){\n                    if(!global.isLogin()){\n                        return null;\n                    }\n                    var tmp={};\n                    var userInfoObj=JSON.parse($.cookie('user_info'));\n                    tmp['userId']=userInfoObj['user_id'];\n                    tmp['userName']=userInfoObj['user_name'];\n                    if(userInfoObj['user_face']){\n                        var userFaceObj=JSON.parse(userInfoObj['user_face']);\n                        //tmp['userFaceSM']=Think['ROOT']+userFaceObj['userFaceSM'];\n                        //tmp['userFaceMD']=Think['ROOT']+userFaceObj['userFaceMD'];\n                        //tmp['userFaceLG']=Think['ROOT']+userFaceObj['userFaceLG'];\n                    }else{\n                        //tmp['userFaceSM']=Think['PUBLIC']+'img/User/user_30x30.png';\n                        //tmp['userFaceMD']=Think['PUBLIC']+'img/User/user_60x60.png';\n                        //tmp['userFaceLG']=Think['PUBLIC']+'img/User/user_120x120.png';\n                    }\n                    return tmp;\n                },\n                //检测Bootstrap编码规范\n                codeCheckBootstrap:function(){\n                    var s=document.createElement(\"script\");\n                    s.onload=function(){\n                        bootlint.showLintReportForCurrentDocument([]);\n                    };\n                    //s.src=Think['ROOT']+'Public/Common/js/bootlint.min.js';\n                    document.body.appendChild(s)\n                },\n                //显示loading加载图\n                loadingShow:function($eleParent){\n                    if(!$eleParent.find('.common_loading').length){\n                        global.$loading.clone().appendTo($eleParent);\n                    }\n                    $eleParent.find('.common_loading').show();\n                },\n                //隐藏loading加载图\n                loadingHidden:function($eleParent){\n                    $eleParent.find('.common_loading').hide();\n                },\n                //结束loading加载图\n                loadingComplete:function($eleParent){\n                    $eleParent.find('.common_loading').html(\n                        '<div class=\"well\">没有更多的数据了, o(︶︿︶)o</div>'\n                    ).show();\n                },\n                errorReport:function(resp){\n                    global.dialogDestroy();\n                    setTimeout(function(){\n                        global.dialogOpen({\n                            title:'错误提示',\n                            content:resp+',请联系客服QQ:924714558',\n                            showCancel:true\n                        });\n                    },1000);\n                }\n            }\n        }());\n\n        /**\n         * home_index_index\n         */\n        (function(){\n            if(window.location.pathname==\"/\"){\n                var newSleep=false;\n                var hotSleep=false;\n                var newStart=10;\n                var hotStart=10;\n                var newFinish=false;\n                var hotFinish=false;\n                $(window).scroll(function(){\n                    var $newList=$('#new_list');\n                    var $hotList=$('#hot_list');\n                    //被滚动条卷进去之后剩下的高度\n                    var newExtraHeight= $newList.offset().top+$newList.outerHeight()-$(window).scrollTop();\n                    var hotExtraHeight= $hotList.offset().top+$hotList.outerHeight()-$(window).scrollTop();\n                    if($(window).height()-newExtraHeight>50){\n                        if(!(newFinish || newSleep)){\n                            $.ajax({\n                                url:'/home/index/ajaxarticlelist',\n                                type:'post',\n                                data:{\n                                    start:newStart,\n                                    type:'new',\n                                    _token:$('body').data().token\n                                },\n                                success:function(data){\n                                    if(data){\n                                        $('#append_new').append(data);\n                                        newStart+=10;\n                                        setTimeout(function(){\n                                            newSleep=false;\n                                        },3000);\n                                    }else{\n                                        newFinish=true;\n                                    }\n                                }\n                            });\n                            newSleep=true;\n                        };\n                    }\n                    if($(window).height()-hotExtraHeight>50){\n                        if(!(hotFinish || hotSleep)){\n                            $.ajax({\n                                url:'/home/index/ajaxarticlelist',\n                                type:'post',\n                                data:{\n                                    start:hotStart,\n                                    type:'hot',\n                                    _token:$('body').data().token\n                                },\n                                success:function(data){\n                                    if(data){\n                                        $('#append_hot').append(data);\n                                        hotStart+=10;\n                                        setTimeout(function(){\n                                            hotSleep=false;\n                                        },3000);\n                                    }else{\n                                        hotFinish=true;\n                                    }\n                                }\n                            });\n                            hotSleep=true;\n                        };\n                    }\n                });\n            }\n        }());\n\n        /**\n         * home_about_offer\n         */\n        (function(){\n            if(window.location.pathname==\"/home/about/offer\"){\n                $('#main div:first-child').removeClass('container');\n                $('body').css({\n                    marginBottom:$(window).height()-$('#rate').height()+\"px\"\n                });\n                $('#main').css({\n                    marginLeft:$(window).width()*0.25\n                });\n                $('#sidebar-ul a').click(function(){\n                    var href=$(this).attr('href');\n                    $('html,body').animate({\n                        scrollTop: $(href).offset().top-55+'px'\n                    },500);\n                    $(this).addClass('active').parent().siblings().find('a').removeClass('active');\n                    return false;\n                });\n            }\n        }());\n        /**\n         * admin_series_create\n         */\n        (function(){\n            if(location.href.indexOf(\"/admin/series\")>0){\n                var $articleMainClassify=$('#articleMainClassify');\n                var $articleSubClassify=$('#articleSubClassify');\n                $(\"#uploaderArea\").dmUploader({\n                    url:'/common/file/uploadFile',\n                    extraData:{\n                        _token:$(\"input[name='_token']\").val(),\n                        filePlace:JSON.stringify({\n                            module:'Series',\n                            folderName:'seriesCover'\n                        })\n                    },\n                    onUploadSuccess:function(uploadId,data){\n                        var dataObj=JSON.parse(data);\n                        $('#seriesCover').val(data);\n                        $('#coverPreview').attr('src',dataObj['file_url']);\n                    }\n                });\n                $articleMainClassify.prepend('<option value=\"\">主分类</option>').val(0);\n                $articleMainClassify.change(function(){\n                    var mainValue=$(this).val();\n                    if(mainValue==0){\n                        $articleSubClassify.empty().parent().hide();\n                    }else{\n                        $.ajax({\n                            url:\"/admin/article/ajaxClassifyList\",\n                            type:\"post\",\n                            data:{\n                                mainId:mainValue,\n                                _token:$(\"input[name='_token']\").val()\n                            },\n                            success:function(data){\n                                var data=JSON.parse(data),subClassifyList;\n                                for(var i in data){\n                                    subClassifyList+=\"<option value=\"+i+\">\"+data[i]+\"</option>\";\n                                }\n                                $articleSubClassify.empty().append(subClassifyList);\n                            }\n                        });\n                        $articleSubClassify.parent().show();\n                    }\n                });\n                $('#submit').click(function(){\n                    var requestData={\n                        _token:$(\"input[name='_token']\").val(),\n                        series_name:$('#seriesName').val(),\n                        series_alias:$('#seriesAlias').val(),\n                        series_cover:$('#seriesCover').val(),\n                        series_main_classify:$articleMainClassify.val(),\n                        series_sub_classify:$articleSubClassify.val()\n                    },requestUrl=\"/admin/series\";\n                    if(location.href.indexOf('edit')>0){\n                        requestData['_method']='patch';\n                        requestData['series_id']=$('#legend').data().src;\n                        requestUrl=location.href.slice(0,-5);\n                    }\n                    $.ajax({\n                        url:requestUrl,\n                        type:\"post\",\n                        data:requestData,\n                        success:function(data){\n                            if(data==1){\n                                location.href='/admin/series';\n                            }\n                        }\n                    });\n                    return false;\n                });\n            }\n        }());\n    });\n}(window,jQuery));\n"],"sourceRoot":"/source/"}