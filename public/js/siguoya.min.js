!function(t,e){e(function(){!function(){if(t.$document=e(document),t.$window=e(t),t.yfx=function(){console.log(arg)},e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")}}),location.href.indexOf("admin")<0&&location.href.indexOf("localhost")<0&&location.href.indexOf("firstdomain")){var a=document.createElement("script");a.src="//hm.baidu.com/hm.js?dbc825061da32f4cf32e3c7c56e95034";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(a,i);var o=document.createElement("script");o.src="//push.zhanzhang.baidu.com/push.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i)}}(),function(){function a(){e(l.get(r)).trigger("click"),r++,r>=n&&(r=0)}var i,o=e(".nav-tabs"),n=o.find("a").length,l=o.find("a"),r=1;i=setInterval(a,3e3),e(".tab-pane").hover(function(){clearInterval(i)},function(){i=setInterval(a,3e3)}),e(".redirectLessons").click(function(){t.location.href="https://www.jetbrains.com/phpstorm/"})}(),function(){e(t).width()<768&&e("#nav-pull-right").removeClass("pull-right")}(),function(){if(e("#editormd").length){var t=editormd("editormd",{height:500,path:"/vendor/editor/lib/",emoji:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!1,dialogMaskOpacity:.7,dialogMaskBgColor:"#000",imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"/common/file/uploadFile"});e("#uploaderArea").length&&e("#uploaderArea").dmUploader({url:"/common/file/uploadFile",extraData:{_token:e("input[name='_token']").val(),filePlace:JSON.stringify({module:"Article",folderName:"articleCover"})},onUploadSuccess:function(t,e){var i=JSON.parse(e);a.$articleCover.val(e),a.$coverPreview.attr("src",i.file_url)}});var a={$articleTitle:e("#articleTitle"),$mainClassify:e("#articleMainClassify"),$subClassify:e("#articleSubClassify"),$articleCover:e("#articleCover"),$submitButton:e("#submit"),$coverPreview:e("#coverPreview"),$articleSummary:e("#articleSummary"),$articleOriginUrl:e("#articleOriginUrl"),mainClassifyChange:function(){var t=e(this).val();0==t?a.subClassifyInit():(a.subClassifyGetList(t),a.$subClassify.parent().show())},subClassifyGetList:function(t){e.isNumeric(t)&&e.ajax({url:"/admin/article/ajaxClassifyList",type:"post",data:{mainId:t,_token:e("input[name='_token']").val()},success:function(t){var e,t=JSON.parse(t);for(var i in t)e+="<option value="+i+">"+t[i]+"</option>";a.$subClassify.empty().append(e)}})},mainClassifyInit:function(){this.$mainClassify.prepend('<option value="">主分类</option>').val(0),this.$mainClassify.change(this.mainClassifyChange)},subClassifyInit:function(){this.$subClassify.empty().parent().hide()},submitFunc:function(t){this.validClassify.call(this),t.call(this)},validClassify:function(){return a.$articleTitle.val()&&a.$mainClassify.val()&&a.$subClassify.val()&&a.$articleSummary.val()&&t.getMarkdown()?!0:!1},init:function(){this.mainClassifyInit(),this.subClassifyInit(),this.$submitButton.click(function(){if(a.validClassify()){var i={_token:e("input[name='_token']").val(),article_title:a.$articleTitle.val(),article_main_classify:a.$mainClassify.val(),article_sub_classify:a.$subClassify.val(),article_cover:a.$articleCover.val(),article_summary:a.$articleSummary.val(),article_content:t.getMarkdown(),article_tags:e("#articleTags").val(),article_keywords:e("#articleKeywords").val(),article_origin_url:function(){return JSON.stringify(a.$articleOriginUrl.val().split(","))}};location.href.indexOf("edit")>0&&(i._method="patch",i.article_id=e("#legend").data().src),e.ajax({url:"/admin/article/store",type:"post",data:i,success:function(t){1==t&&(alert("成功"),location.href="/admin/article/create")}})}else alert("标题,分类,配图,内容都不得为空");return!1})}};a.init()}if(e("#mdContainer").length){editormd.markdownToHTML("markdown",{markdown:e("#mdContainer").val(),markdownSourceCode:!0});var i=e("#articleOriginSource");if(i.length)try{var o=JSON.parse(i.text());e("#articleOriginSource").text("作者:"+o[0]+"\r\n 原文链接:"+o[1]).attr("href",o[1])}catch(n){console.log("Bug:JSON字符串解析出错")}}}(),function(){t.global={$loading:e(".common_loading"),$modalTitle:e("#modalTitle"),$modalContent:e("#modalContent"),$modalCancelButton:e("#modalCancelButton"),$modalOkButton:e("#modalOkButton"),$dialogButton:e("#dialogButton"),$dialogClose:e("#modalClose"),dialogOpen:function(a,i){var o=e.extend({title:"标题",content:"内容",showOk:!1,showCancel:!1,okFunc:null,cancelFunc:null,redirectUrl:""},a);global.$modalTitle.html(o.title),global.$modalContent.html(o.content),o.showCancel?global.$modalCancelButton.show():!0,o.showOk?global.$modalOkButton.show():!0,o.okFunc&&(global.$modalOkButton.unbind("click"),global.$modalOkButton.click(function(){o.okFunc.call(i)})),global.$dialogButton.trigger("click"),o.redirectUrl&&setTimeout(function(){t.location.href=o.redirectUrl},2500)},dialogClose:function(t){var t=t?t:0;setTimeout(function(){global.$dialogClose.trigger("click")},t)},dialogDestroy:function(){global.dialogClose(),global.$modalCancelButton.unbind("click").hide(),global.$modalOkButton.unbind("click"),global.$modalOkButton.click(function(){global.dialogClose()})},isLogin:function(){return e.cookie("user_info")?!0:!1},userInfo:function(){if(!global.isLogin())return null;var t={},a=JSON.parse(e.cookie("user_info"));if(t.userId=a.user_id,t.userName=a.user_name,a.user_face){JSON.parse(a.user_face)}return t},codeCheckBootstrap:function(){var t=document.createElement("script");t.onload=function(){bootlint.showLintReportForCurrentDocument([])},document.body.appendChild(t)},loadingShow:function(t){t.find(".common_loading").length||global.$loading.clone().appendTo(t),t.find(".common_loading").show()},loadingHidden:function(t){t.find(".common_loading").hide()},loadingComplete:function(t){t.find(".common_loading").html('<div class="well">没有更多的数据了, o(︶︿︶)o</div>').show()},errorReport:function(t){global.dialogDestroy(),setTimeout(function(){global.dialogOpen({title:"错误提示",content:t+",请联系客服QQ:924714558",showCancel:!0})},1e3)}}}(),function(){if("/"==t.location.pathname){var a=!1,i=!1,o=10,n=10,l=!1,r=!1;e(t).scroll(function(){var c=e("#new_list"),s=e("#hot_list"),u=c.offset().top+c.outerHeight()-e(t).scrollTop(),d=s.offset().top+s.outerHeight()-e(t).scrollTop();e(t).height()-u>50&&(l||a||(e.ajax({url:"/home/index/ajaxarticlelist",type:"post",data:{start:o,type:"new",_token:e("body").data().token},success:function(t){t?(e("#append_new").append(t),o+=10,setTimeout(function(){a=!1},3e3)):l=!0}}),a=!0)),e(t).height()-d>50&&(r||i||(e.ajax({url:"/home/index/ajaxarticlelist",type:"post",data:{start:n,type:"hot",_token:e("body").data().token},success:function(t){t?(e("#append_hot").append(t),n+=10,setTimeout(function(){i=!1},3e3)):r=!0}}),i=!0))})}}(),function(){"/home/about/offer"==t.location.pathname&&!function(){e("#main div:first-child").removeClass("container"),e("body").css({marginBottom:e(t).height()-e("#rate").height()+"px"}),e("#main").css({marginLeft:.25*e(t).width()}),e("#sidebar-ul a").click(function(){var t=e(this).attr("href");return e("html,body").animate({scrollTop:e(t).offset().top-55+"px"},500),e(this).addClass("active").parent().siblings().find("a").removeClass("active"),!1})}()}()})}(window,jQuery);
