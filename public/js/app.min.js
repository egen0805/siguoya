!function(i,a){a(function(){!function(){if(i.$document=a(document),i.$window=a(i),i.yfx=function(){console.log(arg)},location.href.indexOf("admin")<0){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?dbc825061da32f4cf32e3c7c56e95034";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}}(),function(){function t(){a(n.get(r)).trigger("click"),r++,r>=l&&(r=0)}var e,o=a(".nav-tabs"),l=o.find("a").length,n=o.find("a"),r=1;e=setInterval(t,3e3),a(".tab-pane").hover(function(){clearInterval(e)},function(){e=setInterval(t,3e3)}),a(".redirectLessons").click(function(){i.location.href="/home/backend/tools/phpstorm/"})}(),function(){if(a("#editormd").length){var i=editormd("editormd",{height:500,path:"/vendor/editor/lib/",emoji:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!1,dialogMaskOpacity:.7,dialogMaskBgColor:"#000",imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"/common/file/uploadFile"});a("#uploaderArea").length&&a("#uploaderArea").dmUploader({url:"/common/file/uploadFile",extraData:{_token:a("input[name='_token']").val(),filePlace:JSON.stringify({module:"Article",folderName:"articleCover"})},onUploadSuccess:function(i,a){var e=JSON.parse(a);t.$articleCover.val(a),t.$coverPreview.attr("src",e.file_url)}});var t={$articleTitle:a("#articleTitle"),$mainClassify:a("#articleMainClassify"),$subClassify:a("#articleSubClassify"),$articleCover:a("#articleCover"),$submitButton:a("#submit"),$coverPreview:a("#coverPreview"),$articleSummary:a("#articleSummary"),$articleOriginUrl:a("#articleOriginUrl"),mainClassifyChange:function(){var i=a(this).val();0==i?t.subClassifyInit():(t.subClassifyGetList(i),t.$subClassify.parent().show())},subClassifyGetList:function(i){a.isNumeric(i)&&a.ajax({url:"/admin/article/ajaxClassifyList",type:"post",data:{mainId:i,_token:a("input[name='_token']").val()},success:function(i){var a,i=JSON.parse(i);for(var e in i)a+="<option value="+e+">"+i[e]+"</option>";t.$subClassify.empty().append(a)}})},mainClassifyInit:function(){this.$mainClassify.prepend('<option value="">主分类</option>').val(0),this.$mainClassify.change(this.mainClassifyChange)},subClassifyInit:function(){this.$subClassify.empty().parent().hide()},submitFunc:function(i){this.validClassify.call(this),i.call(this)},validClassify:function(){return t.$articleTitle.val()&&t.$mainClassify.val()&&t.$articleCover.val()&&t.$articleCover.val()&&t.$articleSummary.val()&&i.getMarkdown()?!0:!1},init:function(){this.mainClassifyInit(),this.subClassifyInit(),this.$submitButton.click(function(){if(t.validClassify()){var e={_token:a("input[name='_token']").val(),article_title:t.$articleTitle.val(),article_main_classify:t.$mainClassify.val(),article_sub_classify:t.$subClassify.val(),article_cover:t.$articleCover.val(),article_summary:t.$articleSummary.val(),article_content:i.getMarkdown(),article_tags:a("#articleTags").val(),article_keywords:a("#articleKeywords").val(),article_origin_url:function(){return JSON.stringify(t.$articleOriginUrl.val().split(","))}};location.href.indexOf("edit")>0&&(e._method="patch",e.article_id=a("#legend").data().src),a.ajax({url:"/admin/article/store",type:"post",data:e,success:function(i){1==i&&(alert("成功"),location.href="/admin/article/create")}})}else alert("标题,分类,配图,内容都不得为空");return!1})}};t.init()}if(a("#mdContainer").length){editormd.markdownToHTML("markdown",{markdown:a("#mdContainer").val(),markdownSourceCode:!0});var e=a("#articleOriginSource");if(e.length)try{var o=JSON.parse(e.text());a("#articleOriginSource").text("作者:"+o[0]+"\r\n 原文链接:"+o[1]).attr("href",o[1])}catch(l){console.log("Bug:JSON字符串解析出错")}}}(),function(){i.global={$loading:a(".common_loading"),$modalTitle:a("#modalTitle"),$modalContent:a("#modalContent"),$modalCancelButton:a("#modalCancelButton"),$modalOkButton:a("#modalOkButton"),$dialogButton:a("#dialogButton"),$dialogClose:a("#modalClose"),dialogOpen:function(t,e){var o=a.extend({title:"标题",content:"内容",showOk:!1,showCancel:!1,okFunc:null,cancelFunc:null,redirectUrl:""},t);global.$modalTitle.html(o.title),global.$modalContent.html(o.content),o.showCancel?global.$modalCancelButton.show():!0,o.showOk?global.$modalOkButton.show():!0,o.okFunc&&(global.$modalOkButton.unbind("click"),global.$modalOkButton.click(function(){o.okFunc.call(e)})),global.$dialogButton.trigger("click"),o.redirectUrl&&setTimeout(function(){i.location.href=o.redirectUrl},2500)},dialogClose:function(i){var i=i?i:0;setTimeout(function(){global.$dialogClose.trigger("click")},i)},dialogDestroy:function(){global.dialogClose(),global.$modalCancelButton.unbind("click").hide(),global.$modalOkButton.unbind("click"),global.$modalOkButton.click(function(){global.dialogClose()})},isLogin:function(){return a.cookie("user_info")?!0:!1},userInfo:function(){if(!global.isLogin())return null;var i={},t=JSON.parse(a.cookie("user_info"));if(i.userId=t.user_id,i.userName=t.user_name,t.user_face){JSON.parse(t.user_face)}return i},codeCheckBootstrap:function(){var i=document.createElement("script");i.onload=function(){bootlint.showLintReportForCurrentDocument([])},document.body.appendChild(i)},loadingShow:function(i){i.find(".common_loading").length||global.$loading.clone().appendTo(i),i.find(".common_loading").show()},loadingHidden:function(i){i.find(".common_loading").hide()},loadingComplete:function(i){i.find(".common_loading").html('<div class="well">没有更多的数据了, o(︶︿︶)o</div>').show()},errorReport:function(i){global.dialogDestroy(),setTimeout(function(){global.dialogOpen({title:"错误提示",content:i+",请联系客服QQ:924714558",showCancel:!0})},1e3)}}}()})}(window,jQuery);